!function(a){"use strict";function e(a,b){this.set=a,this.idx=0,this.from=0,this.$ele=b,this.timer=null,this.$lis=b.find(a.content),this.len=this.$lis.length,this.effect=this.EFFECT[a.effect]||function(){},this.isMoving=!1}a.fn.wheel=function(b,c){var d=a.browser.mozilla?"DOMMouseScroll":"mousewheel",e=function(a){var b=a.originalEvent,c={};return"wheelDelta"in b?c.wheelDelta=Math.round(b.wheelDelta)/120:"detail"in b&&(c.wheelDelta=40*-b.detail)/120,c};"on"===b?this.on(d,function(b){a.extend(b,e(b)),c.call(this,b)}):"off"===b&&this.off(d,c)};var d={_COLLECT:[],addCss:function(){var b="<style>.orz{}</style>";a(b).appendTo("head")},OPEN:function(a){for(var b=d._COLLECT,c=0,e=b.length;e>c;c++)this[0]==b[c].$ele[0]&&b[c][a]()}};a.fn.Orz=function(b){a.fn.Orz.defaults={marquee:!1,lazy:!1,wheel:!1,info:!1,vertical:!1,button:!0,auto:!1,effect:"scroll",onMouse:"mouseover",delay:2e3,loop:!1,nav:!1,all:!1,thumbs:!1,content:"ul>li",title:"h2 a"};var c=b?a.extend(a.fn.Orz.defaults,b):a.fn.Orz.defaults;return d[b]?d[b].call(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("\u65b9\u6cd5-------"+b+"---------\u4e0d\u5b58\u5728"),void 0):this.each(function(){var b=new e(c,a(this));b.readyCss(a(this)),b.generate(a(this)),c.auto&&b.auto(),c.marquee&&b.marquee(),c.wheel&&b.wheel(a(this)),a.data(b,"tp",a(this).offset().top),d._COLLECT.push(b)})},d.addCss(),e.prototype={readyCss:function(a){var b=this.set,c=b.vertical?this.$lis.eq(0).outerHeight(!0):this.$lis.eq(0).outerWidth(!0),d=b.vertical?a.height():a.width();switch(this.viewed=Math.ceil(d/c),this.num=this.len,this.fix(b),b.effect){case"scroll":var e,f;if(b.all?(this.WH=d,this.len=Math.ceil(c*this.num/this.WH)):this.WH=c,this.fly=b.vertical?"scrollTop":"scrollLeft",this.$ul=a.children(),this.css={},b.loop){f=document.createDocumentFragment();for(var g=0;g<this.viewed;g++)this.$lis.eq(g).clone().appendTo(f);this.$ul.append(f)}e=b.loop&&!b.vertical?this.WH*this.len+this.viewed*c:this.WH*this.len,b.vertical&&(e=!1),this.$ul.css({width:e||"100%",height:"100%"}).wrap("<div style='overflow:hidden;height:100%;width:100%'></div>").children().css({overflow:"hidden","float":b.vertical?"":"left"}),this.lay=this.$ul.parent();break;case"fade":this.$lis.css({position:"absolute",left:0,top:0}).eq(0).css("zIndex","2").parent().css({height:"100%",overflow:"hidden"})}if(b.lazy){this.$imgs=this.$ul.find("img");for(var g=0;g<this.viewed;g++)this.$imgs.eq(g).attr("src",this.$imgs.eq(g).attr("lazy")).removeAttr("lazy")}},wheel:function(a){var b=this;a.wheel("on",function(a){b.idx+=a.wheelDelta>0?-1:1,(b.idx<0||b.idx>=b.len)&&(b.idx=0),a.preventDefault(),b.start(b.idx)})},generate:function(b){var c=this,d=c.set;if(d.button&&this.len>1){for(var e=a("<ol></ol>").appendTo(b),f="",g=0;g<c.len;g++)f+="<li>"+(g+1)+"</li>";e[0].innerHTML=f,c.olis=e[0].getElementsByTagName("li"),c.olis[0].className="on",b.on(d.onMouse,"ol li",function(){c.stop(),c.start(a(this).index())}).on("mouseout","ol li",function(){d.auto&&c.auto()})}b.on("mouseover",function(){c.stop()}).on("mouseout",function(){d.auto&&c.auto()}),d.nav&&this.len>1&&(a("<a href='javascript:void(0)' onselectstart='return false;' class='pre'><</a><a href='javascript:void(0)' onselectstart='return false' class='next'>></a>").appendTo(b),b.on("click",".pre",function(){return c.nav(c.idx--),!1}).on("click",".next",function(){return c.nav(c.idx++),!1})),d.info&&(a("<strong style='font-size:16px;position:absolute;right:0;top:0;padding:3px 10px;background:#0093D0;color:white;z-index:4'></strong>").html("<b>"+this.viewed+"</b>/"+this.num).appendTo(b),this.$infoNum=b.find("b").get(0)),d.marquee&&b.on("mouseover",function(){c.stop()}).on("mouseleave",function(){c.marquee()}),d.title&&b.on("click",d.title,function(){c.start(a(this).index())})},start:function(a){this.idx=a,this.idx==this.from||this.isMoving||(this.effect(this),this.set.info&&this.EFFECT.__info(this),this.reset())},nav:function(){!this.set.loop&&!this.set.all&&this.idx>this.num-this.viewed&&(this.idx=0),(this.idx<0||this.idx>=this.len)&&(this.idx=0),this.start(this.idx)},stop:function(){clearInterval(this.timer)},auto:function(){this.timer=setInterval(a.proxy(function(){this.idx=this.idx>=this.len-1?0:++this.idx,this.start(this.idx)},this),this.set.delay)},marquee:function(){var b=this.lay[0],c=this.fly,d=this.WH*this.len,e=b[c];this.timer=setInterval(function(){e=e>=d?0:++e,b[c]=e},17)},EFFECT:{scroll:function(a){a.isMoving=!0,a.set.loop&&a.from==a.len-1&&0==a.idx?(a.css[a.fly]+=this.WH,a.lay.animate(a.css,function(){a.lay[0][a.fly]=0,a.isMoving=!1})):(a.css[a.fly]=a.idx*this.WH,a.lay.stop(!0,!1).animate(a.css,function(){a.isMoving=!1}))},fade:function(b){b.isMoving=!0,b.$lis.eq(b.idx).css("zIndex","1"),b.$lis.eq(b.from||0).stop().fadeOut(500,function(){a(this).css({zIndex:0,display:"block"}),b.$lis.eq(b.idx).css("zIndex","2"),b.isMoving=!1})},__info:function(a){a.$infoNum.innerHTML=a.set.all?(a.idx+1)*a.viewed:a.idx+1}},reset:function(){this.set.button&&(this.olis[this.from].className="",this.olis[this.idx].className="on"),this.from=this.idx},fix:function(a){"fade"==a.effect&&(a.loop=!1,a.veritcal=!1,a.all=!1,a.wheel=!1),a.marquee&&(a.all=!0,a.loop=!0,a.auto=!1,a.info=!1,a.button=!1,a.nav=!1,a.wheel=!1),this.viewed>1&&!a.all&&(a.info=!1,a.button=!1),a.lazy&&(a.loop=!1)}}}(jQuery,document);
